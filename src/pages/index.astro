---
import Layout from '../layouts/Layout.astro';
import Header from '../components/Header.astro';
import AuthModalWrapper from '../components/auth/AuthModalWrapper.jsx';
import StoreDebuggerWrapper from '../components/StoreDebuggerWrapper.jsx';
import { getPageData } from '../lib/directus.js';
import DynamicBlocks from '../components/DynamicBlocks.astro';

// Obtener datos de la página de inicio desde Directus
const { data: pageData, error } = await getPageData('/');

// Si hay un error, usar datos por defecto
const blocks = pageData?.blocks || [];
const title = pageData?.title || 'TravelWithGaston - Inicio';
---

<Layout title={title}>
	<Header />
	
	<!-- Contenido principal -->
	<main>
		{/* Contenido de la página si existe */}
		{pageData?.content && (
			<div class="container mx-auto px-4 py-8">
				<div class="prose prose-lg max-w-none mb-8">
					<div set:html={pageData.content} />
				</div>
			</div>
		)}

		{/* Bloques dinámicos */}
		{blocks && blocks.length > 0 && (
			<DynamicBlocks blocks={blocks} />
		)}
	</main>
	<AuthModalWrapper client:load />
	<StoreDebuggerWrapper client:load />
</Layout>
